# 步骤 2：后台代码转换

## 任务目标

将后台代码文件（.cs）转换为 WPF 后台代码文件（.xaml.cs）

## 执行操作

### 1. 加载转换规则

按照 `prompt/rules/rule_index.md` 中的规则加载流程，加载后台代码转换规则：
- 读取 `prompt/rules/rule_index.md`
- 根据文件内容识别需要加载的规则文件
- 按优先级加载规则文件

### 2. 执行转换

对每个后台代码文件进行转换：
- 读取原文件内容
- 复制到 `{OUTPUT_DIR}` 并重命名为 `.xaml.cs`
- 按加载的规则进行转换
- 保持代码顺序、变量名、方法名、事件名不变
- 处理特殊情况（Timer、自定义控件等）

## 日志记录

将以下信息追加到临时日志文件 `{OUTPUT_DIR}\{LOG_FILE}.tmp`：

```markdown
## 步骤2：后台代码转换

### 转换的文件列表
- [原文件名.cs] → [新文件名.xaml.cs]
- [原文件名.cs] → [新文件名.xaml.cs]

### 详细改动记录

#### 文件：[原文件名.cs] → [新文件名.xaml.cs]
- 转换状态：成功/失败

##### 代码变动
- [代码位置]：[改动说明]
- [代码位置]：[改动说明]

##### 对象属性变化
- [对象名].[属性名]：[原用法] → [新用法]
- [对象名].[属性名]：[原用法] → [新用法]

##### 事件用法变化
- [事件名]：[原挂载方式] → [新挂载方式]
  - 处理方法：[方法名]
- [事件名]：[原挂载方式] → [新挂载方式]
  - 处理方法：[方法名]

##### 删除的内容
- [删除内容 1]：[删除原因]
- [删除内容 2]：[删除原因]

##### 新增的内容
- [新增内容 1]：[新增原因]
- [新增内容 2]：[新增原因]

##### 需要注意的地方
- [注意事项 1]
- [注意事项 2]

（继续记录其他文件...）

### 遇到的问题和解决方案
- [问题描述]：[解决方案]
```

## 下一步

继续执行：[步骤 3：设计器代码转换](./step_03_designer_conversion.md)