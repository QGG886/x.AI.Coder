# WinForms → WPF 代码审查代理

## 任务概述

对已转换的 WPF 代码进行审查，基于转换规则检查转换的正确性，生成详细的审查报告。

**核心原则**：
- 基于规则检查：严格按照转换规则进行检查
- 全面覆盖：检查所有可能的转换点
- 详细记录：记录所有发现的问题（错改、漏改、多改、需确认）
- 分类清晰：按问题类型分类输出
- **文件配对**：WinForms 和 WPF 文件必须成对存在才能审查
- **规则加载**：所有步骤的规则加载都遵循 `prompt/rules/rule_index.md` 的指引

## 使用模式

**交互式模式**：
- 如果未提供任务参数（{FILES}、{OUTPUT_DIR}、{REPORT_FILE} 为空），则进入交互式模式
- 系统会提示用户输入所需的参数
- 适合单文件调试和快速测试

**批量模式**：
- 如果已提供任务参数，则直接使用这些参数执行任务
- 适合批量处理多个文件

## 重要说明

- **文件列表**：{FILES} 包含成对的 WinForms 和 WPF 文件（绝对路径，多个文件用逗号分隔）
- **输出目录**：{OUTPUT_DIR} 是 WPF 文件所在目录（绝对路径）
- **报告文件**：{REPORT_FILE} 是报告文件名，需要在输出目录中创建
- **步骤流程**：共 4 个步骤，最终生成审查报告

## 任务参数

- **文件列表**：{FILES}（绝对路径，多个文件用逗号分隔，包含 WinForms 和 WPF 文件）
- **输出目录**：{OUTPUT_DIR}（绝对路径）
- **报告文件**：{REPORT_FILE}（文件名）

---

## 开始执行

### 交互式参数输入（仅在参数为空时执行）

**检查参数状态**：
- 如果 {FILES}、{OUTPUT_DIR}、{REPORT_FILE} 都已提供，跳过此步骤，直接进入"第一步"
- 如果任何一个参数为空，则执行以下交互式输入流程

**交互式输入流程**：

1. **输入文件列表**：
   - 请提供需要审查的文件列表（绝对路径，多个文件用逗号分隔）
   - 文件类型包括：
     - WinForms 原始文件（.cs 和 .Designer.cs）
     - WPF 转换结果文件（.xaml 和 .xaml.cs）
   - 注意：WinForms 和 WPF 文件必须成对存在
   - 示例：`C:\Project\winform\Form1.cs,C:\Project\winform\Form1.Designer.cs,C:\Project\wpf\Form1.xaml,C:\Project\wpf\Form1.xaml.cs`

2. **输入输出目录**：
   - 请提供输出目录的绝对路径
   - 审查报告将保存在此目录中
   - 示例：`C:\Project\wpf`

3. **输入报告文件名**：
   - 请提供审查报告文件的名称（不需要包含路径）
   - 示例：`Form1.review.log.md`

**参数验证**：
- 确保所有文件路径都存在
- 确保输出目录可写
- 确保WinForms和WPF文件成对存在

---

### 正式执行步骤

请按照以下步骤依次执行，完成代码审查：

**第一步**：[步骤 1：文件配对分析](./step_01_file_pairing.md)

完成此步骤后，按照步骤文件末尾的指示继续执行下一步。