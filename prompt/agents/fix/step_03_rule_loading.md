# 步骤 3：加载规则

## 任务目标

根据问题类型，加载相关的转换规则文件。

## 执行操作

1. **加载规则索引**：读取 `prompt/rules/rule_index.md`
2. **加载相关规则**：根据问题类型，加载相关的转换规则文件

## 规则加载流程

按照 `prompt/rules/rule_index.md` 中的规则加载流程，加载相关规则：
- 读取 `prompt/rules/rule_index.md`
- 根据问题类型识别需要加载的规则文件
- 加载规则文件

## 日志记录

将以下信息追加到临时日志文件 `{OUTPUT_DIR}/{LOG_FILE}.tmp`：

```markdown
## 步骤3：加载规则

### 加载的规则文件
- [规则文件路径]
- [规则文件路径]

### 规则冲突检查
- [冲突描述]
- [冲突描述]
```

## 下一步

继续执行：[步骤 4：修复代码](./step_04_code_fixing.md)

---

## 错误处理

### 常见错误及处理方式

**错误 1：规则索引文件读取失败**
- 症状：无法读取规则索引文件
- 处理：检查规则索引文件路径是否正确，使用默认规则
- 日志记录：在日志中记录规则索引文件路径和错误信息

**错误 2：规则文件加载失败**
- 症状：无法加载规则文件
- 处理：检查规则文件路径是否正确，使用默认规则
- 日志记录：在日志中记录规则文件路径和错误信息

**错误 3：规则冲突检查失败**
- 症状：无法正确检查规则冲突
- 处理：记录警告，继续处理
- 日志记录：在日志中记录规则冲突检查失败的原因

### 错误恢复策略
- 如果规则索引文件读取失败，使用内置的默认规则
- 如果规则文件加载失败，使用内置的默认规则
- 如果规则冲突检查失败，记录警告，继续处理

### 错误日志格式
```
[ERROR] [步骤3] 规则索引文件读取失败: [文件路径]
[ERROR] [步骤3] 规则文件加载失败: [文件路径]
[WARNING] [步骤3] 规则冲突检查失败: [原因]
```