# 步骤 1：文件分类和加载

## 任务目标

识别 `{FILES}` 中的文件类型，读取所有文件内容。

## 执行操作

1. **识别文件类型**：根据文件扩展名将传入的文件列表分类
2. **读取所有文件内容**：读取所有文件的内容，保存到内存中
3. **验证文件完整性**：确保每个文件组都包含必要的文件

## 文件类型识别

根据文件扩展名识别文件类型：
- `*.cs` 但不是 `*.Designer.cs`：WinForms 主代码文件
- `*.Designer.cs`：WinForms 设计器文件
- `*.xaml`：WPF XAML 文件
- `*.xaml.cs`：WPF 代码隐藏文件
- `*.trans.log.md`：转换日志文件
- `*.review.log.md`：审查日志文件

## 日志记录

将以下信息写入临时日志文件 `{OUTPUT_DIR}/{LOG_FILE}.tmp`：

```markdown
## 步骤1：文件分类和加载

### 文件列表
- 总文件数：X

### 文件分类
#### WinForms 文件
- 设计器代码文件：X
- 后台代码文件：X

#### WPF 文件
- XAML 文件：X
- 后台代码文件：X

#### 日志文件
- 转换日志：X
- 审查日志：X

### 文件完整性验证
- [文件名]：验证通过/失败
- [文件名]：验证通过/失败
```

## 下一步

继续执行：[步骤 2：分析日志](./step_02_log_analysis.md)

---

## 错误处理

### 常见错误及处理方式

**错误 1：文件读取失败**
- 症状：无法读取文件内容
- 处理：检查文件路径是否正确，文件是否存在
- 日志记录：在日志中记录文件路径和错误信息

**错误 2：文件类型识别失败**
- 症状：无法正确识别文件类型
- 处理：检查文件扩展名，使用默认分类
- 日志记录：在日志中记录无法识别的文件

**错误 3：文件完整性验证失败**
- 症状：缺少必要的文件
- 处理：记录警告，继续处理
- 日志记录：在日志中记录缺失的文件

### 错误恢复策略
- 如果文件读取失败，跳过该文件，继续处理其他文件
- 如果文件类型识别失败，使用默认分类，继续处理
- 如果文件完整性验证失败，记录警告，继续处理

### 错误日志格式
```
[ERROR] [步骤1] 文件读取失败: [文件路径]
[ERROR] [步骤1] 文件类型识别失败: [文件名]
[WARNING] [步骤1] 文件完整性验证失败: [文件名] - 缺少必要的文件
```